# my-game
import tkinter as tk    2 from tkinter import messagebox    3 import random    4    5 class PuzzleGame:    6     def _init__(self, master, size=3):    7         self.master = master    8         self.master.title("拼圖小遊戲")    9         self.size = size   10         self.tiles = []   11         self.buttons = []   12         self.empty_tile = (self.size - 1, self.size - 1)   13         self.colors = ["#EEE4DA", "#EDE0C8", "#F2B179", "#F59563",   14                        "#F67C5F", "#F65E3B", "#EDCF72", "#EDCC61",   15                        "#F9F6F2", "#E0B9A4", "#D2B48C", "#BDB76B"]   16         self.create_tiles()   17         self.create_ui()   18         self.shuffle_tiles()   19   20     def create_tiles(self):   21         self.tiles = [[self.size * r + c + 1 for c in range(self.size)] for r in range(self.size)]   22         self.tiles[self.size-1][self.size-1] = None   23   24     def create_ui(self):   25         for r in range(self.size):   26             row = []   27             for c in range(self.size):   28                 btn = tk.Button(self.master, font=("Arial", 24), width=4, height=2,   29                                 command=lambda row=r, col=c: self.move_tile(row, col))   30                 btn.grid(row=r, column=c)   31                 row.append(btn)   32             self.buttons.append(row)   33         self.update_ui()   34   35     def update_ui(self):   36         for r in range(self.size):   37             for c in range(self.size):   38                 val = self.tiles[r][c]   39                 if val is None:   40                     self.buttons[r][c]["text"] = ""   41                     self.buttons[r][c]["bg"] = "black"   42                 else:   43                     self.buttons[r][c]["text"] = str(val)   44                     color_index = (val - 1) % len(self.colors)   45                     self.buttons[r][c]["bg"] = self.colors[color_index]   46                     self.buttons[r][c]["fg"] = "white"   47   48     def move_tile(self, r, c):   49         er, ec = self.empty_tile   50         if abs(er - r) + abs(ec - c) == 1:   51             self.tiles[er][ec], self.tiles[r][c] = self.tiles[r][c], self.tiles[er][ec]   52             self.empty_tile = (r, c)   53             self.update_ui()   54             if self.check_win():   55                 self.master.after(100, self.handle_win)   56   57     def handle_win(self):   58         messagebox.showinfo("恭喜", "你完成拼圖了！")   59         if messagebox.askyesno("下一關", f"要挑戰 {self.size + 1}x{self.size + 1} 的拼圖嗎？"):   60             self.master.destroy()   61             root = tk.Tk()   62             game = PuzzleGame(root, size=self.size + 1)   63             root.mainloop()   64         else:   65             self.master.destroy()   66   67     def shuffle_tiles(self):   68         moves = [(-1,0),(1,0),(0,-1),(0,1)]   69         for _ in range(self.size * self.size * 10): # Increase shuffles for larger puzzles   70             er, ec = self.empty_tile   71             possible = []   72             for dr, dc in moves:   73                 nr, nc = er+dr, ec+dc   74                 if 0 <= nr < self.size and 0 <= nc < self.size:   75                     possible.append((nr, nc))   76             if possible:   77                 nr, nc = random.choice(possible)   78                 # Perform the move without animation or win check for shuffling   79                 self.tiles[er][ec], self.tiles[nr][nc] = self.tiles[nr][nc], self.tiles[er][ec]   80                 self.empty_tile = (nr, nc)   81         self.update_ui() # Update UI once after shuffling   82   83     def check_win(self):   84         num = 1   85         for r in range(self.size):   86             for c in range(self.size):   87                 if r == self.size-1 and c == self.size-1:   88                     return self.tiles[r][c] is None   89                 if self.tiles[r][c] != num:   90                     return False   91                 num += 1   92         return True   93   94 if __name_ == "_main_":   95     root = tk.Tk()   96     game = PuzzleGame(root)   97     root.mainloop()
